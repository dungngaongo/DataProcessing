{#
    Partial HTML dựng 3 sheet:
    - Sizing: có logic đặc biệt cho KPI/tiến độ và mapping dự án
    - Cấp phát TN: hỗ trợ mapping sang Chi tiết
    - Chi tiết: bảng dữ liệu chi tiết
    Header cột có điều khiển chèn/xoá và đổi tên (HTMX + contenteditable)
#}
<div class="sheet-container">
    <div id="sizing-sheet" class="sheet active">
        <table class="excel-table">
            <thead>
                <tr>
                {% for col in sizing_columns %}
                    <th class="col-header-cell">
                        <span contenteditable="true"
                            class="col-header-name"
                            data-sheet="Sizing"
                            data-col-index="{{ loop.index0 }}"
                            data-old-col-name="{{ col }}">
                            {{ col }}
                        </span>
                        <div class="col-controls">
                            <button type="button"
                                    title="Thêm cột bên trái"
                                    hx-prompt="Nhập tên cột mới (ví dụ: 'Cột mới'):"
                                    hx-vals='{"new_col_name": "${prompt}"}'
                                    hx-post="/handle-col/Sizing/insert/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">↤+</button>
                            {% if col != 'STT' %}
                            <button type="button"
                                    title="Xóa cột này"
                                    hx-confirm="Bạn có chắc muốn xóa cột {{ col }}?"
                                    hx-post="/handle-col/Sizing/delete/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">×</button>
                            {% endif %}
                        </div>
                    </th>
                {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% if sizing_rows and sizing_rows|length > 0 %}
                {% for row in sizing_rows %}
                    <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                        {% for col in sizing_columns %}
                            {% if col == 'Tên dự án - Mục đích sizing' %}
                            <td contenteditable="true" class="cell project-link" data-project="{{ row[col]|blanknan }}" data-sheet="Sizing" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}">{{ row[col]|blanknan }}</td>
                            {% elif col == 'Thời gian hoàn thành theo KPI' %}
                            <td class="cell kpi-date-cell" data-sheet="Sizing" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}" style="background:#f5f5f5;color:#888;">{{ row[col]|blanknan }}</td>
                            {% elif col == 'Tiến độ' %}
                            <td class="cell {{ row[col]|progress_class }}" data-sheet="Sizing" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}">{{ row[col]|blanknan }}</td>
                            {% else %}
                            <td contenteditable="true" class="cell" data-sheet="Sizing" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}">{{ row[col]|blanknan }}</td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr class="add-row-trigger" data-after="{{ loop.index0 }}">
                        <td colspan="{{ sizing_columns|length }}" class="add-row-cell">
                            <button type="button" class="add-row-btn" hx-post="/add-row/Sizing/{{ loop.index0 }}" hx-target="#sizing-sheet" hx-swap="outerHTML">+</button>
                            <button type="button" class="delete-row-btn" hx-post="/delete-row/Sizing/{{ loop.index0 }}" hx-target="#sizing-sheet" hx-swap="outerHTML">×</button>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="{{ sizing_columns|length }}" class="empty">(Chưa có dữ liệu)</td></tr>
                <tr class="add-row-trigger always-show" data-after="-1">
                    <td colspan="{{ sizing_columns|length }}" class="add-row-cell">
                        <button type="button" class="add-row-btn" hx-post="/add-row/Sizing/-1" hx-target="#sizing-sheet" hx-swap="outerHTML">+</button>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    <div id="cap-phat-sheet" class="sheet">
        <table class="excel-table">
            <thead>
                <tr>
                {% for col in cap_phat_columns %}
                    <th class="col-header-cell">
                        <span contenteditable="true"
                            class="col-header-name"
                            data-sheet="CapPhat"
                            data-col-index="{{ loop.index0 }}"
                            data-old-col-name="{{ col }}">
                            {{ col }}
                        </span>
                        <div class="col-controls">
                            <button type="button"
                                    title="Thêm cột bên trái"
                                    hx-prompt="Nhập tên cột mới (ví dụ: 'Cột mới'):"
                                    hx-vals='{"new_col_name": "${prompt}"}'
                                    hx-post="/handle-col/CapPhat/insert/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">↤+</button>
                            {% if col != 'STT' %}
                            <button type="button"
                                    title="Xóa cột này"
                                    hx-confirm="Bạn có chắc muốn xóa cột {{ col }}?"
                                    hx-post="/handle-col/CapPhat/delete/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">×</button>
                            {% endif %}
                        </div>
                    </th>
                {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% if cap_phat_rows and cap_phat_rows|length > 0 %}
                {% for row in cap_phat_rows %}
                    <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                        {% for col in cap_phat_columns %}
                            {% if col == 'Dự án' %}
                            <td contenteditable="true" class="cell cap-project-link" data-sheet="CapPhat" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}" data-cap-project="{{ row[col]|blanknan }}">{{ row[col]|blanknan }}</td>
                            {% else %}
                            <td contenteditable="true" class="cell" data-sheet="CapPhat" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}">{{ row[col]|blanknan }}</td>
                            {% endif %}
                        {% endfor %}
                    </tr>
                    <tr class="add-row-trigger" data-after="{{ loop.index0 }}">
                        <td colspan="{{ cap_phat_columns|length }}" class="add-row-cell">
                            <button type="button" class="add-row-btn" hx-post="/add-row/CapPhat/{{ loop.index0 }}" hx-target="#cap-phat-sheet" hx-swap="outerHTML">+</button>
                            <button type="button" class="delete-row-btn" hx-post="/delete-row/CapPhat/{{ loop.index0 }}" hx-target="#cap-phat-sheet" hx-swap="outerHTML">×</button>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="{{ cap_phat_columns|length }}" class="empty">(Chưa có dữ liệu)</td></tr>
                <tr class="add-row-trigger always-show" data-after="-1">
                    <td colspan="{{ cap_phat_columns|length }}" class="add-row-cell">
                        <button type="button" class="add-row-btn" hx-post="/add-row/CapPhat/-1" hx-target="#cap-phat-sheet" hx-swap="outerHTML">+</button>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    <div id="chi-tiet-sheet" class="sheet">
        <table class="excel-table">
            <thead>
                <tr>
                {% for col in chi_tiet_columns %}
                    <th class="col-header-cell">
                        <span contenteditable="true"
                            class="col-header-name"
                            data-sheet="ChiTiet"
                            data-col-index="{{ loop.index0 }}"
                            data-old-col-name="{{ col }}">
                            {{ col }}
                        </span>
                        <div class="col-controls">
                            <button type="button"
                                    title="Thêm cột bên trái"
                                    hx-prompt="Nhập tên cột mới (ví dụ: 'Cột mới'):"
                                    hx-vals='{"new_col_name": "${prompt}"}'
                                    hx-post="/handle-col/ChiTiet/insert/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">↤+</button>
                            {% if col != 'STT' %}
                            <button type="button"
                                    title="Xóa cột này"
                                    hx-confirm="Bạn có chắc muốn xóa cột {{ col }}?"
                                    hx-post="/handle-col/ChiTiet/delete/{{ loop.index0 }}"
                                    hx-target="#tables-container"
                                    hx-swap="innerHTML">×</button>
                            {% endif %}
                        </div>
                    </th>
                {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% if chi_tiet_rows and chi_tiet_rows|length > 0 %}
                {% for row in chi_tiet_rows %}
                    <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                        {% for col in chi_tiet_columns %}
                            <td contenteditable="true" class="cell" data-sheet="ChiTiet" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="{{ col }}">{{ row[col]|blanknan }}</td>
                        {% endfor %}
                    </tr>
                    <tr class="add-row-trigger" data-after="{{ loop.index0 }}">
                        <td colspan="{{ chi_tiet_columns|length }}" class="add-row-cell">
                            <button type="button" class="add-row-btn" hx-post="/add-row/ChiTiet/{{ loop.index0 }}" hx-target="#chi-tiet-sheet" hx-swap="outerHTML">+</button>
                            <button type="button" class="delete-row-btn" hx-post="/delete-row/ChiTiet/{{ loop.index0 }}" hx-target="#chi-tiet-sheet" hx-swap="outerHTML">×</button>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr><td colspan="{{ chi_tiet_columns|length }}" class="empty">(Chưa có dữ liệu)</td></tr>
                <tr class="add-row-trigger always-show" data-after="-1">
                    <td colspan="{{ chi_tiet_columns|length }}" class="add-row-cell">
                        <button type="button" class="add-row-btn" hx-post="/add-row/ChiTiet/-1" hx-target="#chi-tiet-sheet" hx-swap="outerHTML">+</button>
                    </td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
        <div id="cloud-sheet" class="sheet">
            <div class="cloud-section indent">
                <div class="section-bar">Tài nguyên QHĐC 2020</div>
                <div class="cloud-subtitle">Hiện trạng tài nguyên còn dư</div>
                {% set labels2020 = [
                    'TN còn lại sau KH Q4',
                    'TN trong KH Q4',
                    'TN đã sử dụng trong Q4',
                    'TN còn lại 2021',
                    'Sử dụng 2021',
                    'TN còn lại'
                ] %}
                <table class="excel-table">
                    <thead>
                        <tr>
                            <th rowspan="2">&nbsp;</th>
                            <th colspan="2">vCPU</th>
                            <th colspan="2">RAM(TB)</th>
                            <th rowspan="2">CEPH(GB)</th>
                            <th rowspan="2">SAN(GB)</th>
                            <th rowspan="2">NAS(GB)</th>
                            <th rowspan="2" class="cloud-note-col">Ghi chú</th>
                        </tr>
                        <tr class="cloud-subrow">
                            <th>Com_Ceph</th>
                            <th>Com_SAN</th>
                            <th>Com_Ceph</th>
                            <th>Com_SAN</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for row in cloud_rows %}
                        <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                            <td class="cell" style="font-weight:600; background:#eaf1fb;">{{ labels2020[loop.index0] if loop.index0 < labels2020|length else '' }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="Com_Ceph vCPU">{{ row['Com_Ceph vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="Com_SAN vCPU">{{ row['Com_SAN vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="Com_Ceph RAM(TB)">{{ row['Com_Ceph RAM(TB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="Com_SAN RAM(TB)">{{ row['Com_SAN RAM(TB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="CEPH(GB)">{{ row['CEPH(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="SAN(GB)">{{ row['SAN(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="NAS(GB)">{{ row['NAS(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="Ghi chú">{{ row['Ghi chú']|blanknan }}</td>
                        </tr>
                    {% endfor %}
                    {% if not cloud_rows or cloud_rows|length == 0 %}
                        <tr><td colspan="9" class="empty">(Chưa có dữ liệu)</td></tr>
                    {% endif %}
                    </tbody>
                </table>
            </div>

            <div class="cloud-section indent">
                <div class="section-bar">Private Cloud</div>
                <div class="cloud-subtitle">Hiện trạng tài nguyên còn dư</div>
                {% set labelsPC = [
                    'Tổng TN 2021','Đã cấp phát 2021','TN còn lại 2021',
                    'Tổng TN 2023','Đã cấp phát 2023','TN còn lại 2023'
                ] %}
                <table class="excel-table">
                    <thead>
                        <tr>
                            <th>&nbsp;</th>
                            <th colspan="2">vCPU</th>
                            <th colspan="2">RAM(GB)</th>
                            <th>CEPH(GB)</th><th>SAN(GB)</th><th>NAS(GB)</th>
                            <th class="cloud-wide-col">NAS(theo đầu mới VHKTT gửi tháng 3 2025)</th>
                            <th>Ghi chú</th>
                        </tr>
                        <tr class="cloud-subrow">
                            <th></th>
                            <th>Com_Ceph</th><th>Com_SAN</th>
                            <th>Com_Ceph</th><th>Com_SAN</th>
                            <th></th><th></th><th></th><th></th><th></th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for row in cloud_rows %}
                        <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                            <td class="cell" style="font-weight:600; background:#eaf1fb;">{{ labelsPC[loop.index0] if loop.index0 < labelsPC|length else '' }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC Com_Ceph vCPU">{{ row['PC Com_Ceph vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC Com_SAN vCPU">{{ row['PC Com_SAN vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC Com_Ceph RAM(GB)">{{ row['PC Com_Ceph RAM(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC Com_SAN RAM(GB)">{{ row['PC Com_SAN RAM(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC CEPH(GB)">{{ row['PC CEPH(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC SAN(GB)">{{ row['PC SAN(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC NAS(GB)">{{ row['PC NAS(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="NAS(theo đầu mới VHKTT gửi tháng 3 2025)">{{ row['NAS(theo đầu mới VHKTT gửi tháng 3 2025)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="PC Ghi chú">{{ row['PC Ghi chú']|blanknan }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="cloud-section indent">
                <div class="section-bar">Tài nguyên QHĐC 2021</div>
                <div class="cloud-subtitle">Hiện trạng tài nguyên còn dư</div>
                {% set labels2021 = [
                    'Tổng TN', 'Đã cấp phát', 'TN còn lại'
                ] %}
                <table class="excel-table">
                    <thead>
                        <tr>
                            <th>&nbsp;</th>
                            <th colspan="2">vCPU</th>
                            <th colspan="2">RAM(GB)</th>
                            <th>CEPH(GB)</th><th>SAN(GB)</th><th>NAS(GB)</th>
                            <th>NAS(theo đầu mới VHKTT gửi tháng 3 2025)</th>
                            <th>Ghi chú</th>
                        </tr>
                        <tr class="cloud-subrow">
                            <th></th>
                            <th>Com_Ceph</th><th>Com_SAN</th>
                            <th>Com_Ceph</th><th>Com_SAN</th>
                            <th></th><th></th><th></th><th></th><th></th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for row in cloud_rows[:3] %}
                        <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                            <td class="cell" style="font-weight:600; background:#eaf1fb;">{{ labels2021[loop.index0] if loop.index0 < labels2021|length else '' }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 Com_Ceph vCPU">{{ row['2021 Com_Ceph vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 Com_SAN vCPU">{{ row['2021 Com_SAN vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 Com_Ceph RAM(GB)">{{ row['2021 Com_Ceph RAM(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 Com_SAN RAM(GB)">{{ row['2021 Com_SAN RAM(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 CEPH(GB)">{{ row['2021 CEPH(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 SAN(GB)">{{ row['2021 SAN(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 NAS(GB)">{{ row['2021 NAS(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 NAS(theo đầu mới VHKTT gửi tháng 3 2025)">{{ row['2021 NAS(theo đầu mới VHKTT gửi tháng 3 2025)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2021 Ghi chú">{{ row['2021 Ghi chú']|blanknan }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="cloud-section">
                <div class="section-bar">Tài nguyên QHĐC 2022</div>
                <div class="cloud-subtitle">Hiện trạng tài nguyên còn dư</div>
                {% set labels2022 = ['Tổng TN','Đã cấp phát','TN còn lại'] %}
                <table class="excel-table">
                    <thead>
                        <tr>
                            <th rowspan="2">&nbsp;</th>
                            <th colspan="2">Com_Ceph</th>
                            <th rowspan="2">CEPH(GB)</th>
                            <th colspan="2">Com_SAN</th>
                            <th rowspan="2">SAN(GB)</th>
                            <th rowspan="2">NAS(GB)</th>
                            <th rowspan="2">Object(GB)</th>
                            <th colspan="2">Com_Bigdata</th>
                            <th rowspan="2">Bigdata(GB)</th>
                            <th rowspan="2">Archiving(GB)</th>
                            <th colspan="2">Bare_metal</th>
                            <th rowspan="2">Ghi chú</th>
                        </tr>
                        <tr class="cloud-subrow">
                            <th>vCPU</th><th>RAM</th>
                            <th>vCPU</th><th>RAM</th>
                            <th>vCPU</th><th>RAM</th>
                            <th>vCPU</th><th>RAM</th>
                        </tr>
                    </thead>
                    <tbody>
                    {% for row in cloud_rows[:3] %}
                        <tr class="data-row" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}">
                            <td class="cell" style="font-weight:600; background:#eaf1fb;">{{ labels2022[loop.index0] if loop.index0 < labels2022|length else '' }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_Ceph vCPU">{{ row['2022 Com_Ceph vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_Ceph RAM">{{ row['2022 Com_Ceph RAM']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 CEPH(GB)">{{ row['2022 CEPH(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_SAN vCPU">{{ row['2022 Com_SAN vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_SAN RAM">{{ row['2022 Com_SAN RAM']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 SAN(GB)">{{ row['2022 SAN(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 NAS(GB)">{{ row['2022 NAS(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Object(GB)">{{ row['2022 Object(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_Bigdata vCPU">{{ row['2022 Com_Bigdata vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Com_Bigdata RAM">{{ row['2022 Com_Bigdata RAM']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Bigdata(GB)">{{ row['2022 Bigdata(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Archiving(GB)">{{ row['2022 Archiving(GB)']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Bare_metal vCPU">{{ row['2022 Bare_metal vCPU']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Bare_metal RAM">{{ row['2022 Bare_metal RAM']|blanknan }}</td>
                            <td contenteditable="true" class="cell" data-sheet="Cloud" data-row="{{ loop.index0 }}" data-row-id="{{ row['row_id'] }}" data-col="2022 Ghi chú">{{ row['2022 Ghi chú']|blanknan }}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
</div>
<script src="{{ url_for('static', filename='js/kpi.js') }}"></script>